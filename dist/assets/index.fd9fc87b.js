import{f as C,w as q,g as b,h as G,c as f,i as c,t as H,u as v,n as R,F,j as z,k as D,l as T,m as X,o as p,p as Y,q as L}from"./vendor.dfdafc47.js";var S={itemWidth:30,itemHeight:30,preset:{low:{width:9,height:9,mineNum:10},medium:{width:16,height:16,mineNum:40},high:{width:30,height:16,mineNum:99}}};const V=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],I=w=>{let{width:i,height:n,mineNum:m}=w.value,d=C(m);q(w,()=>{i=w.value.width,n=w.value.height,d.value=m=w.value.mineNum});let a=C([]),k=C(!1),g=b(()=>E.value===w.value.width*w.value.height),E=b(()=>a.value.flat().filter(e=>e.isShow||e.isMark).length);const x=()=>{A();let e=new Array(i*n).fill("").map((s,l)=>l+1);J(e,m).forEach(s=>{let l=Math.floor(s/i),r=s%i-1;s%i==0&&(l=l-1,r=i-1),a.value[l][r].isMine=!0}),B(V)},A=()=>{for(let e=0;e<n;e++){let t=[];for(let s=0;s<i;s++)t.push({isShow:!1,mineNum:0,isMine:!1,isMark:!1,pos:{y:e,x:s}});a.value.push(t)}},B=e=>{for(let t=0;t<n;t++)for(let s=0;s<i;s++)if(!a.value[t][s].isMine){let l=0;y(e,t,s,(r,_)=>{a.value[r][_].isMine&&l++}),l===0||(a.value[t][s].mineNum=l)}},y=(e,t,s,l)=>{for(let r=0;r<e.length;r++){const[_,W]=e[r];let $=t+_,j=s+W;$>=0&&$<n&&j>=0&&j<i&&l($,j)}},N=()=>{for(let e=0;e<n;e++)for(let t=0;t<i;t++)a.value[e][t].isMine&&!a.value[e][t].isMark&&(a.value[e][t].isShow=!0)},M=()=>{a.value=[],k.value=!1,x()},o=e=>{if(!(k.value||g.value)&&!e.isShow){if(e.isMark){e.isMark=!1;return}e.isShow=!0,e.isMine&&(e.hitMine=!0,k.value=!0,N()),e.mineNum===0&&h(e.pos.y,e.pos.x)}},h=(e,t)=>{y(V,e,t,(s,l)=>{let r=a.value[s][l];const _=r.isShow;r.isShow=!0,r.mineNum===0&&!_&&h(s,l)})},u=e=>{d.value!==0&&(e.isMark||(e.isMark=!0,d.value--))};return x(),{list:a,showAll:N,reset:M,mineHandle:o,markMine:u,markNum:d,gameover:k,gamewin:g}},J=function(w,i){let n=w.slice(0),m=n.length;for(;m>1;){let d=Math.floor(Math.random()*m);m--;let a=n[m];n[m]=n[d],n[d]=a}return n.slice(0,i)};const K={class:"sweeper-wrapper"},O=c("h1",null,"\u626B\u96F7",-1),P={class:"action-wrapper"},Q=c("span",{class:"btn"},"\u81EA\u5B9A\u4E49",-1),U={class:"info-wrapper"},Z=c("span",null,"\u5012\u8BA1\u65F6",-1),ee=["onClick","onContextmenu"],te={key:0},ie=G({setup(w){T(M=>({"536dec40":n.width,"4ded8f66":n.height}));const i=C(S.preset.medium),n={width:`${S.itemWidth}px`,height:`${S.itemHeight}px`},m=b(()=>({width:`${i.value.width*S.itemWidth}px`})),d=M=>{const{isShow:o,isMine:h,isMark:u,hitMine:e}=M;let t="";return u?t="isMarkShow":o&&(h?t=e?"isRedMineShow":"isMineShow":t="isShow"),["mineField",t]},a=new Map([[1,"#021AFF"],[2,"#1E8000"],[3,"#F80701"],[4,"#010780"],[5,"#800201"],[6,"red"]]),{list:k,reset:g,mineHandle:E,markMine:x,markNum:A,gameover:B,gamewin:y}=I(i),N=M=>{i.value=S.preset[M],X(()=>{g()})};return(M,o)=>(p(),f("section",K,[O,c("div",P,[c("span",{class:"btn",onClick:o[0]||(o[0]=h=>N("low"))},"\u57FA\u7840"),c("span",{class:"btn",onClick:o[1]||(o[1]=h=>N("medium"))},"\u4E2D\u7EA7"),c("span",{class:"btn",onClick:o[2]||(o[2]=h=>N("high"))},"\u4E13\u5BB6"),Q]),c("div",U,[c("span",null,H(v(A)),1),c("i",{class:R(["iconfont emoj",v(B)?"icon-bukaixin":v(y)?"icon-xiaolian-":"icon-kaixin"]),onClick:o[3]||(o[3]=(...h)=>v(g)&&v(g)(...h))},null,2),Z]),c("section",{class:"game-wrapper",style:D(v(m))},[(p(!0),f(F,null,z(v(k),h=>(p(),f(F,null,[(p(!0),f(F,null,z(h,u=>(p(),f("div",{class:R(["",d(u)]),onClick:e=>v(E)(u),onContextmenu:Y(e=>v(x)(u),["prevent"])},[u.isShow?(p(),f(F,{key:0},[u.isMine?(p(),f("span",te,"x")):L("",!0),u.mineNum?(p(),f("span",{key:1,class:"mineNum",style:D({color:v(a).get(u.mineNum)})},H(u.mineNum),5)):L("",!0)],64)):L("",!0)],42,ee))),256))],64))),256))],4)]))}});export{ie as default};
